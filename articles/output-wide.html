<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="mapme.biodiversity">
<title>How To: Transform indicator output to wide-format â€¢ mapme.biodiversity</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="How To: Transform indicator output to wide-format">
<meta property="og:description" content="mapme.biodiversity">
<meta property="og:image" content="https://mapme-initiative.github.io/mapme.biodiversity/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">mapme.biodiversity</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/quickstart.html">Quickstart</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/introduction.html">Introduction</a>
    <a class="dropdown-item" href="../articles/installation.html">Installation</a>
    <a class="dropdown-item" href="../articles/terminology.html">Terminology</a>
    <a class="dropdown-item" href="../articles/workflow.html">Workflow</a>
    <a class="dropdown-item" href="../articles/contributing.html">Contributing</a>
  </div>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-how-to-s">How To's</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-how-to-s">
    <a class="dropdown-item" href="../articles/output-wide.html">Transform output to wide</a>
    <a class="dropdown-item" href="../articles/nasa-firms.html">Use downloaded resources</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/mapme-initiative/mapme.biodiversity/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>How To: Transform indicator output to wide-format</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/mapme-initiative/mapme.biodiversity/blob/HEAD/vignettes/output-wide.Rmd" class="external-link"><code>vignettes/output-wide.Rmd</code></a></small>
      <div class="d-none name"><code>output-wide.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Linking to GEOS 3.10.2, GDAL 3.4.1, PROJ 8.2.1; sf_use_s2() is TRUE</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mapme-initiative.github.io/mapme.biodiversity/index.html">mapme.biodiversity</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="objectives">Objectives<a class="anchor" aria-label="anchor" href="#objectives"></a>
</h2>
<p>This tutorial gives you some information how to transform the output
of the mapme-biodiversity package to a wide format for exchange with
other (geospatial-)software, such as QGIS. This is necessary because the
package uses the so-called nested-list format by default to support very
different indicators that each may come in its own format. However, this
format is specific to R and to use the data in other software thus
requires some additional steps to be taken. This vignette thus shows you
how you can obtain a wide-format for your portfolio that you can easily
export and use with other software.</p>
</div>
<div class="section level2">
<h2 id="what-are-long-vs--wide-tables">What are long vs.Â wide tables?<a class="anchor" aria-label="anchor" href="#what-are-long-vs--wide-tables"></a>
</h2>
<p>Tabular data can be structured in two different ways, which are
usually referred to as long and wide format. Most people are more
familiar with the wide format, because this is a format we as humans
would naturally structure our data when we work with spreadsheets,
e.g.Â in Excel. In wide-format, the identifier of a observation is
included exactly once and does not repeat itself (see Table A). In the
long format, the identifier as well as other qualifying variables, might
be repeated several times to uniquely identify each observation is a
single row (see Table B). The long format is often required when
interacting with computers, e.g.Â to make plots with ggplot2. The content
of the two is exactly the same either way, the one might be just more
friendly to humans than to computers. If you are familiar with the R
tidyverse, you might also have heard of the term <em>tidy</em> data. In
terms of tabular data you can imagine <em>tidy</em> data to be referring
to data in a long table which naturally fulfills the following
requirements:</p>
<ul>
<li>each variable has its own column</li>
<li>each observation has its own row</li>
<li>each value has its own cell</li>
</ul>
<div class="figure">
<img src="assets/img/wide-long-tables.png" alt=""><p class="caption">Fig. 1: Example of a wide and long table holding the
same data.</p>
</div>
<p>Table A, in that sense, is not <em>tidy</em> since the year variable
is not found in its own column but instead it is scattered in two
different columns. Table B is a long format with each variable being
found in exactly one column. In that sense, each individual row
represents exactly one observation, meaning the observation of a
specific country in a specific year.</p>
<p>When we structure data in the long format the objects will usually
have a larger memory footprint than compared to a wide format. For
smaller objects or data types with small memory consumption, this might
not pose a serious limitation to the workflow. However, geometry
information, here indicated as a WKT string, might quickly accumulate a
large proportion of the available memory, even more so if the portfolio
consists of a high number of complex geometries that are then copied to
fit the the long-format requirement. For that reason, this packages uses
a nested-list format to hold tables for indicators as single columns
within the portfolio. The remainder of this tutorial will show you in
more detail how you can work with those R specific data format.</p>
</div>
<div class="section level2">
<h2 id="the-simple-case---single-row-indicators">The simple case - single-row indicators<a class="anchor" aria-label="anchor" href="#the-simple-case---single-row-indicators"></a>
</h2>
<p>We start by reading a GeoPackage from disk. For the sake of the
argument, we split the original single polygon into 9 distinct polygons
to simulate a realistic portfolio consisting of multiple assets.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">aoi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">read_sf</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"sierra_de_neiba_478140_2.gpkg"</span>,</span>
<span>    package <span class="op">=</span> <span class="st">"mapme.biodiversity"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">aoi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_make_grid.html" class="external-link">st_make_grid</a></span><span class="op">(</span><span class="va">aoi</span>, n <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">aoi</span><span class="op">)</span></span>
<span><span class="co">#&gt; Simple feature collection with 9 features and 0 fields</span></span>
<span><span class="co">#&gt; Geometry type: POLYGON</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -71.80933 ymin: 18.57668 xmax: -71.33201 ymax: 18.69931</span></span>
<span><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span><span class="co">#&gt;                                x</span></span>
<span><span class="co">#&gt; 1 POLYGON ((-71.80933 18.5766...</span></span>
<span><span class="co">#&gt; 2 POLYGON ((-71.65022 18.5766...</span></span>
<span><span class="co">#&gt; 3 POLYGON ((-71.49111 18.5766...</span></span>
<span><span class="co">#&gt; 4 POLYGON ((-71.80933 18.6175...</span></span>
<span><span class="co">#&gt; 5 POLYGON ((-71.65022 18.6175...</span></span>
<span><span class="co">#&gt; 6 POLYGON ((-71.49111 18.6175...</span></span>
<span><span class="co">#&gt; 7 POLYGON ((-71.80933 18.6584...</span></span>
<span><span class="co">#&gt; 8 POLYGON ((-71.65022 18.6584...</span></span>
<span><span class="co">#&gt; 9 POLYGON ((-71.49111 18.6584...</span></span></code></pre></div>
<p>As a simple example, suppose we interested in extracting the average
traveltime to cities between 20,000 and 50,000 inhabitants in our
portfolio. As usual, we will have to make available the Nelson et
al.Â resource as well as requesting the calculation of the respective
indicator.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">port</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/init_portfolio.html">init_portfolio</a></span><span class="op">(</span></span>
<span>  <span class="va">aoi</span>,</span>
<span>  years <span class="op">=</span> <span class="fl">2018</span>,</span>
<span>  outdir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"res"</span>, package <span class="op">=</span> <span class="st">"mapme.biodiversity"</span><span class="op">)</span>,</span>
<span>  tmpdir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"tmp"</span>, package <span class="op">=</span> <span class="st">"mapme.biodiversity"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">port_w_nelson</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_resources.html">get_resources</a></span><span class="op">(</span><span class="va">port</span>, <span class="st">"nelson_et_al"</span>, range_traveltime <span class="op">=</span> <span class="st">"20k_50k"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Starting process to download resource 'nelson_et_al'........</span></span>
<span><span class="co">#&gt; Skipping existing files in output directory.</span></span>
<span><span class="va">port_w_traveltime</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_indicators.html">calc_indicators</a></span><span class="op">(</span><span class="va">port_w_nelson</span>, <span class="st">"traveltime"</span>, stats_accessibility <span class="op">=</span> <span class="st">"mean"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Argument 'engine' for resource 'traveltime' was not specified. Setting to default value of 'extract'.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">port_w_traveltime</span><span class="op">)</span></span>
<span><span class="co">#&gt; Simple feature collection with 9 features and 2 fields</span></span>
<span><span class="co">#&gt; Geometry type: POLYGON</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -71.80933 ymin: 18.57668 xmax: -71.33201 ymax: 18.69931</span></span>
<span><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 9 Ã— 3</span></span></span>
<span><span class="co">#&gt;   assetid traveltime                                                           x</span></span>
<span><span class="co">#&gt;     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>                                                   <span style="color: #949494; font-style: italic;">&lt;POLYGON [Â°]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>       1 <span style="color: #949494;">&lt;tibble [1 Ã— 2]&gt;</span> ((-71.80933 18.57668, -71.65022 18.57668, -71.65022 â€¦</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>       2 <span style="color: #949494;">&lt;tibble [1 Ã— 2]&gt;</span> ((-71.65022 18.57668, -71.49111 18.57668, -71.49111 â€¦</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>       3 <span style="color: #949494;">&lt;tibble [1 Ã— 2]&gt;</span> ((-71.49111 18.57668, -71.33201 18.57668, -71.33201 â€¦</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>       4 <span style="color: #949494;">&lt;tibble [1 Ã— 2]&gt;</span> ((-71.80933 18.61756, -71.65022 18.61756, -71.65022 â€¦</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>       5 <span style="color: #949494;">&lt;tibble [1 Ã— 2]&gt;</span> ((-71.65022 18.61756, -71.49111 18.61756, -71.49111 â€¦</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>       6 <span style="color: #949494;">&lt;tibble [1 Ã— 2]&gt;</span> ((-71.49111 18.61756, -71.33201 18.61756, -71.33201 â€¦</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span>       7 <span style="color: #949494;">&lt;tibble [1 Ã— 2]&gt;</span> ((-71.80933 18.65844, -71.65022 18.65844, -71.65022 â€¦</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">8</span>       8 <span style="color: #949494;">&lt;tibble [1 Ã— 2]&gt;</span> ((-71.65022 18.65844, -71.49111 18.65844, -71.49111 â€¦</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">9</span>       9 <span style="color: #949494;">&lt;tibble [1 Ã— 2]&gt;</span> ((-71.49111 18.65844, -71.33201 18.65844, -71.33201 â€¦</span></span></code></pre></div>
<p>As we can observe from the output, two new columns were added to the
sf object. The first is called <code>assetid</code> and simply is a
unique identifier of the respective asset. The second column is called
<code>traveltime</code> and is of type <code>list</code> indicating that
it represents a nested-list column. What that means is that we are able
to maintain the rectangular shape of our original data (e.g.Â one polygon
per row), while supporting arbitrarily shaped outputs for indicators.
Letâ€™s observe how the traveltime indicator looks like in this
instance:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">port_w_traveltime</span><span class="op">$</span><span class="va">traveltime</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 Ã— 2</span></span></span>
<span><span class="co">#&gt;   minutes_mean distance</span></span>
<span><span class="co">#&gt;          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>         49.8 20k_50k</span></span></code></pre></div>
<p>From the syntax above, you can see how you can access a single object
within the nested list column (e.g.Â by using the list accessor
<code>[[</code>). In this case, the shape of the traveltime indicator is
a single-row and two-column tibble with the average minutes and the
distance category as its value. Because the indicator comes as a single
row, we can simply unnest the traveltime column to get to a wide-format
output:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">port_wide_1</span> <span class="op">&lt;-</span> <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html" class="external-link">unnest</a></span><span class="op">(</span><span class="va">port_w_traveltime</span>, <span class="va">traveltime</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">port_wide_1</span><span class="op">)</span></span>
<span><span class="co">#&gt; Simple feature collection with 9 features and 3 fields</span></span>
<span><span class="co">#&gt; Geometry type: POLYGON</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -71.80933 ymin: 18.57668 xmax: -71.33201 ymax: 18.69931</span></span>
<span><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 9 Ã— 4</span></span></span>
<span><span class="co">#&gt;   assetid minutes_mean distance                                                x</span></span>
<span><span class="co">#&gt;     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                       <span style="color: #949494; font-style: italic;">&lt;POLYGON [Â°]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>       1         49.8 20k_50k  ((-71.80933 18.57668, -71.65022 18.57668, -71.6â€¦</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>       2        104.  20k_50k  ((-71.65022 18.57668, -71.49111 18.57668, -71.4â€¦</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>       3        112.  20k_50k  ((-71.49111 18.57668, -71.33201 18.57668, -71.3â€¦</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>       4         84   20k_50k  ((-71.80933 18.61756, -71.65022 18.61756, -71.6â€¦</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>       5        139.  20k_50k  ((-71.65022 18.61756, -71.49111 18.61756, -71.4â€¦</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>       6        104.  20k_50k  ((-71.49111 18.61756, -71.33201 18.61756, -71.3â€¦</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span>       7        141.  20k_50k  ((-71.80933 18.65844, -71.65022 18.65844, -71.6â€¦</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">8</span>       8        118.  20k_50k  ((-71.65022 18.65844, -71.49111 18.65844, -71.4â€¦</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">9</span>       9         73.1 20k_50k  ((-71.49111 18.65844, -71.33201 18.65844, -71.3â€¦</span></span></code></pre></div>
<p>In this case, the result has 9 rows just like the original data
frame. In this particular scenario, where the only variable is
<code>minutes_mean</code>, the object <code>port_wide_1</code> contains
just one value per polygon. This aligns well with the characteristics of
the wide format, which can be easily understood and processed by various
(geospatial) software. So, we can now export our portfolio for example
as a geopackage that can be read directly into e.g.Â QGIS or as a CSV
without the geospatial information:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_write.html" class="external-link">st_write</a></span><span class="op">(</span><span class="va">port_wide_1</span>, dsn <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".gpkg"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Writing layer `file250c27f18fe4' to data source </span></span>
<span><span class="co">#&gt;   `/tmp/RtmpmTsAcr/file250c27f18fe4.gpkg' using driver `GPKG'</span></span>
<span><span class="co">#&gt; Writing 9 features with 3 fields and geometry type Polygon.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_drop_geometry</a></span><span class="op">(</span><span class="va">port_wide_1</span><span class="op">)</span>, file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".csv"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="the-harder-case---indicators-with-multi-row-output">The harder case - indicators with multi-row output<a class="anchor" aria-label="anchor" href="#the-harder-case---indicators-with-multi-row-output"></a>
</h2>
<p>Letâ€™s continue to query an indicator which has a multi-row output,
i.e. precipitation statistics from <a href="https://www.worldclim.org/" class="external-link">WorldClim</a>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">port_w_chirps</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_resources.html">get_resources</a></span><span class="op">(</span><span class="va">port</span>, <span class="st">"worldclim_precipitation"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Starting process to download resource 'worldclim_precipitation'........</span></span>
<span><span class="co">#&gt; Skipping existing files in output directory.</span></span>
<span><span class="va">port_w_prec</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_indicators.html">calc_indicators</a></span><span class="op">(</span><span class="va">port_w_chirps</span>, <span class="st">"precipitation_wc"</span>, stats_worldclim <span class="op">=</span> <span class="st">"mean"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Argument 'engine' for resource 'precipitation_wc' was not specified. Setting to default value of 'extract'.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">port_w_prec</span><span class="op">)</span></span>
<span><span class="co">#&gt; Simple feature collection with 9 features and 2 fields</span></span>
<span><span class="co">#&gt; Geometry type: POLYGON</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -71.80933 ymin: 18.57668 xmax: -71.33201 ymax: 18.69931</span></span>
<span><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 9 Ã— 3</span></span></span>
<span><span class="co">#&gt;   assetid precipitation_wc                                                     x</span></span>
<span><span class="co">#&gt;     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>                                                   <span style="color: #949494; font-style: italic;">&lt;POLYGON [Â°]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>       1 <span style="color: #949494;">&lt;tibble [12 Ã— 2]&gt;</span> ((-71.80933 18.57668, -71.65022 18.57668, -71.65022â€¦</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>       2 <span style="color: #949494;">&lt;tibble [12 Ã— 2]&gt;</span> ((-71.65022 18.57668, -71.49111 18.57668, -71.49111â€¦</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>       3 <span style="color: #949494;">&lt;tibble [12 Ã— 2]&gt;</span> ((-71.49111 18.57668, -71.33201 18.57668, -71.33201â€¦</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>       4 <span style="color: #949494;">&lt;tibble [12 Ã— 2]&gt;</span> ((-71.80933 18.61756, -71.65022 18.61756, -71.65022â€¦</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>       5 <span style="color: #949494;">&lt;tibble [12 Ã— 2]&gt;</span> ((-71.65022 18.61756, -71.49111 18.61756, -71.49111â€¦</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>       6 <span style="color: #949494;">&lt;tibble [12 Ã— 2]&gt;</span> ((-71.49111 18.61756, -71.33201 18.61756, -71.33201â€¦</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span>       7 <span style="color: #949494;">&lt;tibble [12 Ã— 2]&gt;</span> ((-71.80933 18.65844, -71.65022 18.65844, -71.65022â€¦</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">8</span>       8 <span style="color: #949494;">&lt;tibble [12 Ã— 2]&gt;</span> ((-71.65022 18.65844, -71.49111 18.65844, -71.49111â€¦</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">9</span>       9 <span style="color: #949494;">&lt;tibble [12 Ã— 2]&gt;</span> ((-71.49111 18.65844, -71.33201 18.65844, -71.33201â€¦</span></span></code></pre></div>
<p>We see that similar to the traveltime indicator, the output consists
of 9 rows with the precipitation indicator as a single nested-list
column. Note, however, the differences when we take a look at the shape
of a the indicator for a specific asset:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">port_w_prec</span><span class="op">$</span><span class="va">precipitation_wc</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 12 Ã— 2</span></span></span>
<span><span class="co">#&gt;    prec_mean date      </span></span>
<span><span class="co">#&gt;        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>      21.1 2018-01-01</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>      21.4 2018-02-01</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>      61.4 2018-03-01</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>      83.6 2018-04-01</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     331.  2018-05-01</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>      60.3 2018-06-01</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>      74.0 2018-07-01</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>      94.0 2018-08-01</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     207.  2018-09-01</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>     126.  2018-10-01</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span>      52.6 2018-11-01</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span>      20.2 2018-12-01</span></span></code></pre></div>
<p>For a single asset, we obtain a tibble with 12 rows (for each month
in the queried year 2018). Now, if we just simply unnest this indicator
column observe what happens to the shape of the output:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">port_wide_2</span> <span class="op">&lt;-</span> <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html" class="external-link">unnest</a></span><span class="op">(</span><span class="va">port_w_prec</span>, <span class="va">precipitation_wc</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">port_wide_2</span><span class="op">)</span></span>
<span><span class="co">#&gt; Simple feature collection with 108 features and 3 fields</span></span>
<span><span class="co">#&gt; Geometry type: POLYGON</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -71.80933 ymin: 18.57668 xmax: -71.33201 ymax: 18.69931</span></span>
<span><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 108 Ã— 4</span></span></span>
<span><span class="co">#&gt;    assetid prec_mean date                                                      x</span></span>
<span><span class="co">#&gt;      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>                                        <span style="color: #949494; font-style: italic;">&lt;POLYGON [Â°]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>       1      21.1 2018-01-01 ((-71.80933 18.57668, -71.65022 18.57668, -71.6â€¦</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>       1      21.4 2018-02-01 ((-71.80933 18.57668, -71.65022 18.57668, -71.6â€¦</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>       1      61.4 2018-03-01 ((-71.80933 18.57668, -71.65022 18.57668, -71.6â€¦</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>       1      83.6 2018-04-01 ((-71.80933 18.57668, -71.65022 18.57668, -71.6â€¦</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>       1     331.  2018-05-01 ((-71.80933 18.57668, -71.65022 18.57668, -71.6â€¦</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>       1      60.3 2018-06-01 ((-71.80933 18.57668, -71.65022 18.57668, -71.6â€¦</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>       1      74.0 2018-07-01 ((-71.80933 18.57668, -71.65022 18.57668, -71.6â€¦</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>       1      94.0 2018-08-01 ((-71.80933 18.57668, -71.65022 18.57668, -71.6â€¦</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>       1     207.  2018-09-01 ((-71.80933 18.57668, -71.65022 18.57668, -71.6â€¦</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>       1     126.  2018-10-01 ((-71.80933 18.57668, -71.65022 18.57668, -71.6â€¦</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># â„¹ 98 more rows</span></span></span></code></pre></div>
<p>Instead of 9 rows, we get a tibble with 108 rows (9 assets * 12),
with the metadata for each asset as well as the geometry column being
repeated. This is not desirable, especially for portfolios with large
numbers of assets where the repetition of the geometry data can cause
very large objects. Now, letâ€™s investigate how we still are able to get
a wide output. A valid approach is to re-shape the indicators per asset
to a wide format before unnesting the indicator column. For this, letâ€™s
write a function which takes the precipitation indicator of a single
asset as input and transforms it to a wide-format.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prec2wide</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span><span class="va">data</span>, names_from <span class="op">=</span> <span class="va">date</span>, values_from <span class="op">=</span> <span class="va">prec_mean</span>, names_prefix <span class="op">=</span> <span class="st">"prec-"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">prec2wide</span><span class="op">(</span><span class="va">port_w_prec</span><span class="op">$</span><span class="va">precipitation_wc</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 Ã— 12</span></span></span>
<span><span class="co">#&gt;   `prec-2018-01-01` `prec-2018-02-01` `prec-2018-03-01` `prec-2018-04-01`</span></span>
<span><span class="co">#&gt;               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>              21.1              21.4              61.4              83.6</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># â„¹ 8 more variables: `prec-2018-05-01` &lt;dbl&gt;, `prec-2018-06-01` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `prec-2018-07-01` &lt;dbl&gt;, `prec-2018-08-01` &lt;dbl&gt;, `prec-2018-09-01` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `prec-2018-10-01` &lt;dbl&gt;, `prec-2018-11-01` &lt;dbl&gt;, `prec-2018-12-01` &lt;dbl&gt;</span></span></span></code></pre></div>
<p>From the example output above we see that our custom
<code>prec2wide()</code> functions takes a single tibble as input, puts
in the dates appended by <code>prec-</code> as column names and the
associated average precipitation values as a single row. Now, we can use
functionality of the <code>purrr</code> package to map this function
over our indicator column, save the result in a new column (or simply
overwrite the original), and finally simply call unnest to get the
output in a wide format.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">port_w_prec</span><span class="op">$</span><span class="va">precipitation_wc2</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">port_w_prec</span><span class="op">$</span><span class="va">precipitation_wc</span>, <span class="va">prec2wide</span><span class="op">)</span></span>
<span><span class="va">port_w_prec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">port_w_prec</span>, <span class="va">assetid</span>, <span class="va">precipitation_wc2</span><span class="op">)</span></span>
<span><span class="va">port_wide_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html" class="external-link">unnest</a></span><span class="op">(</span><span class="va">port_w_prec</span>, <span class="va">precipitation_wc2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">port_wide_3</span><span class="op">)</span></span>
<span><span class="co">#&gt; Simple feature collection with 9 features and 13 fields</span></span>
<span><span class="co">#&gt; Geometry type: POLYGON</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -71.80933 ymin: 18.57668 xmax: -71.33201 ymax: 18.69931</span></span>
<span><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 9 Ã— 14</span></span></span>
<span><span class="co">#&gt;   assetid `prec-2018-01-01` `prec-2018-02-01` `prec-2018-03-01`</span></span>
<span><span class="co">#&gt;     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>       1              21.1              21.4              61.4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>       2              25.9              24.5              62.0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>       3              24.5              24.2              58.4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>       4              32.1              28.1              72.8</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>       5              28.7              28.4              68.4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>       6              17.6              19.8              54.4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span>       7              24.5              24.3              69.9</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">8</span>       8              19.4              21.1              62.8</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">9</span>       9              14.2              17.5              52.2</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># â„¹ 10 more variables: `prec-2018-04-01` &lt;dbl&gt;, `prec-2018-05-01` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `prec-2018-06-01` &lt;dbl&gt;, `prec-2018-07-01` &lt;dbl&gt;, `prec-2018-08-01` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `prec-2018-09-01` &lt;dbl&gt;, `prec-2018-10-01` &lt;dbl&gt;, `prec-2018-11-01` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `prec-2018-12-01` &lt;dbl&gt;, x &lt;POLYGON [Â°]&gt;</span></span></span></code></pre></div>
<p>We can now use <code><a href="https://r-spatial.github.io/sf/reference/st_write.html" class="external-link">st_write()</a></code> to save this wide-format sf
object to a geospatial format of our choice or drop the geometry
information altogether and dump the data into a csv.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_write.html" class="external-link">st_write</a></span><span class="op">(</span><span class="va">port_wide_3</span>, dsn <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".gpkg"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Writing layer `file250c312acd9b' to data source </span></span>
<span><span class="co">#&gt;   `/tmp/RtmpmTsAcr/file250c312acd9b.gpkg' using driver `GPKG'</span></span>
<span><span class="co">#&gt; Writing 9 features with 13 fields and geometry type Polygon.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_drop_geometry</a></span><span class="op">(</span><span class="va">port_wide_3</span><span class="op">)</span>, file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".csv"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="http://dariusgoergen.com/" class="external-link">Darius A. GÃ¶rgen</a>, Om Prakash Bhandari.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
